version: '3.8'

services:
  email-automation:
    build: .
    container_name: arbi-email-automation
    restart: unless-stopped
    ports:
      - "3400:3400"
    environment:
      - GMAIL_CREDENTIALS_PATH=/credentials/gmail_credentials.json
      - GMAIL_TOKEN_PATH=/credentials/gmail_token.json
      - DISCORD_WEBHOOK_URL=${DISCORD_WEBHOOK_URL}
      - CHECK_INTERVAL=${CHECK_INTERVAL:-300}
    volumes:
      - ./data:/data
      - /root/.openclaw/workspace/gmail_credentials.json:/credentials/gmail_credentials.json:ro
      - /root/.openclaw/workspace/gmail_token.json:/credentials/gmail_token.json:ro
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3400/health"]
      interval: 5m
      timeout: 10s
      retries: 3
      start_period: 30s
